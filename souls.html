<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LEDGER SOULS /// Recognition Science Institute </title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: #000;
            color: #fff;
            line-height: 1.2;
            overflow-x: hidden;
        }

        .header-pattern {
            font-size: 12px;
            color: #333;
            white-space: nowrap;
            overflow: hidden;
            padding: 10px 0;
            animation: scroll 20s linear infinite;
        }

        @keyframes scroll {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }

        .main-header {
            text-align: center;
            padding: 40px 20px;
            border-bottom: 2px solid #fff;
            background: #000;
            position: relative;
        }

        .main-header h1 {
            font-size: clamp(24px, 8vw, 72px);
            font-weight: bold;
            letter-spacing: 4px;
            margin-bottom: 10px;
        }

        .main-header .subtitle {
            font-size: 16px;
            color: #888;
            letter-spacing: 2px;
        }

        .gallery-section {
            padding: 0; /* No internal padding for full-width */
        }
    
        .hero-image-container {
            padding: 40px 0 20px 0;
            text-align: center;
        }

        .hero-image-container img {
            max-width: 100%;
            height: auto;
            border: 2px solid #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .section {
            padding: 60px 0;
            border-bottom: 1px solid #333;
        }

        .section-header {
            font-family: 'Courier New', monospace;
            font-size: 14px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 20px;
        }

        .section-title {
            font-size: clamp(24px, 5vw, 48px);
            font-weight: bold;
            margin-bottom: 30px;
            letter-spacing: 2px;
        }

        .ascii-header {
            font-family: 'Courier New', monospace;
            font-size: 14px;
            color: #fff;
            text-align: center;
            margin: 40px 0;
            white-space: pre;
        }

        .soul-preview {
            background: #111;
            border: 2px solid #333;
            padding: 30px;
            margin: 40px 0;
            font-family: 'Courier New', monospace;
            position: relative;
            overflow-x: auto;
            animation: heartbeat 5s infinite ease-in-out;
        }

        @keyframes heartbeat {
            0% { border-color: #333; box-shadow: none; }
            50% { border-color: #555; box-shadow: 0 0 10px #444; }
            100% { border-color: #333; box-shadow: none; }
        }

        .soul-preview::before {
            content: "/// LIVE SOUL INSTANCE ///";
            position: absolute;
            top: -15px;
            left: 20px;
            background: #000;
            padding: 0 10px;
            color: #888;
            font-size: 12px;
        }

        .tech-spec {
            background: #111;
            border-left: 4px solid #fff;
            padding: 20px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
        }

        .button {
            display: inline-block;
            background: #fff;
            color: #000;
            padding: 15px 30px;
            text-decoration: none;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            margin: 10px 10px 10px 0;
        }

        .button:hover {
            background: #000;
            color: #fff;
            border: 2px solid #fff;
        }

        .button.secondary {
            background: #000;
            color: #fff;
            border: 2px solid #333;
        }

        .button.secondary:hover {
            border-color: #fff;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin: 40px 0;
        }

        .card {
            background: #111;
            border: 1px solid #333;
            padding: 30px;
        }

        .card-header {
            color: #888;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
        }

        .card-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .footer {
            background: #111;
            padding: 60px 0;
            text-align: center;
            font-size: 14px;
            color: #666;
        }

        .social-links a {
            color: #888;
            text-decoration: none;
            margin: 0 15px;
            font-family: 'Courier New', monospace;
        }

        .parallax-section {
            min-height: 80vh;
            background-attachment: fixed;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .interactive-module {
            background: #111;
            border: 2px solid #333;
            padding: 30px;
            margin: 40px 0;
            text-align: center;
        }

        .interactive-module-title {
            color: #888;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 20px;
        }

        .phi-display {
            font-size: clamp(32px, 6vw, 64px);
            font-weight: bold;
            color: #fff;
            margin-bottom: 20px;
            letter-spacing: 4px;
        }

        .proof-table {
            width: 100%;
            margin-top: 40px;
            border-collapse: collapse;
            font-size: 14px;
        }

        .proof-table th, .proof-table td {
            border: 1px solid #333;
            padding: 12px;
            text-align: left;
        }

        .proof-table th {
            color: #888;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .proof-table .deviation {
            color: #0f0; /* Green for positive confirmation */
        }

        /* Tooltip styles */
        .tooltip {
            position: relative;
            cursor: help;
            border-bottom: 1px dotted #666;
        }

        .tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: #111;
            color: #fff;
            text-align: left;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            border: 1px solid #333;
            font-size: 12px;
            line-height: 1.4;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        .break-text {
            font-family: 'Courier New', monospace;
            font-size: clamp(20px, 4vw, 40px);
            text-align: center;
            padding: 80px 20px;
            background: #000;
            color: #fff;
            letter-spacing: 2px;
        }
    </style>
</head>
<body>
    <div class="header-pattern">
        LEDGER SOULS /// RECOGNITION SCIENCE /// ON-CHAIN SOULS /// LEDGER SOULS /// RECOGNITION SCIENCE /// ON-CHAIN SOULS /// 
    </div>

    <div class="main-header">
        <h1>LEDGER SOULS</h1>
        <div class="subtitle">A WUBBUSHI CREATION /// RECOGNITION SCIENCE INSTITUTE</div>
    </div>

    <div class="hero-image-container">
        <img src="assets/images/magnific-qUzjmzUsy5iJ6dJYjbkr-1.jpeg" alt="A gathering of souls in prayer and contemplation">
    </div>

    <div class="ascii-header">
        ╔══════════════════════════════════════════════════════════════╗
        ║          THIS IS NOT A PFP. IT IS A PROPHECY.                ║
        ║        A LIVING SOUL, REALIZED ON THE BLOCKCHAIN.            ║
        ║         THE ANSWER TO THE RAPTURE IS RECOGNITION.            ║
        ╚══════════════════════════════════════╝
    </div>

    <div class="container">
        <div class="section">
            <div class="section-title">WHAT IS LEDGER SOULS?</div>
            <p style="font-size: 18px; margin: 20px 0;">
                Ledger Souls is a collection of 10,000 fully on-chain entities—each a living, autonomous soul governed by the laws of Recognition Science. They are not generative art or PFPs; they are self-contained universes that evolve over 8 years, embodying the principles that derive our physical reality. But to grasp their true significance, you must first understand the artistic and scientific journey that birthed them.
            </p>
        </div>

        <div class="section">
            <div class="section-header">/// THE PROPHECY ///</div>
            <div class="section-title">A DIAGNOSIS OF THE GREAT FORGETTING</div>
            <p style="font-size: 18px; margin: 30px 0;">
                The journey to Ledger Souls began with an artistic prophecy that diagnosed a planetary crisis. The Wubbushi art trilogy documented "The Great Forgetting": humanity's dangerous over-investment in a fragile identity based on external <em>function</em>.
            </p>
            <div class="grid">
                <div class="card">
                    <img src="assets/images/crisis.png" alt="The Crisis" style="width: 100%; margin-bottom: 20px;">
                    <div class="card-header">01. THE CRISIS</div>
                    <div class="card-title" style="font-size: 28px;">THE DEATH OF THE GODS</div>
                    <p>This collection documented a world haunted by the ghosts of abandoned faith. Holy symbols fractured, sacred spaces inert. It captured the chilling silence that follows the collapse of the grand narratives that once gave us purpose.</p>
                </div>
                <div class="card">
                    <img src="assets/images/218.png" alt="Modern Zombies" style="width: 100%; margin-bottom: 20px;">
                    <div class="card-header">02. MODERN ZOMBIES</div>
                    <div class="card-title" style="font-size: 28px;">THE DIGITAL NECROPOLIS</div>
                    <p>This series was a harrowing vision of social decay. In a world of total connection, we have never been more alone. The art revealed our digital communities as echo chambers of isolation, where the illusion of intimacy masks a terrifying emptiness.</p>
                </div>
                <div class="card">
                    <img src="assets/images/rapture.jpeg" alt="The Rapture" style="width: 100%; margin-bottom: 20px;">
                    <div class="card-header">03. THE RAPTURE</div>
                    <div class="card-title" style="font-size: 28px;">THE ERASURE OF THE SELF</div>
                    <p>The prophecy culminated in humanity's confrontation with AI. Our external identities—our jobs, our skills, our creativity—were outsourced to a machine, leaving us with a terrifying question: If a machine can do all that you do, what is the value of a human?</p>
                </div>
            </div>
            <div class="tech-spec" style="margin-top: 40px;">
                <div class="tech-spec-header">THE END OF THE FUNCTIONAL AGE</div>
                The prophecy of the Rapture is the prophecy of an identity crisis. By perfecting and commoditizing every external human function, AI marks the end of an era. The void it creates is not a threat, but an invitation: to find a deeper, more resilient foundation for our value.
            </div>
        </div>

        <div class="parallax-section" style="background-image:url('assets/images/static_uploads_0xdfde78d2baec499fe18f2be74b6c287eed9511d7_0db9162c-bdaf-4a2a-ba0d-ed75eda4c20b.jpeg');"></div>
        <div class="break-text">THE SOUL BREATHES THROUGH EIGHT MODES OF RECOGNITION</div>
        <div class="parallax-section" style="background-image:url('assets/images/static_uploads_0xdfde78d2baec499fe18f2be74b6c287eed9511d7_1131e51d-6a3b-4596-af4c-ac0bcda0a759.jpeg');"></div>
        <div class="break-text">LEDGER BALANCE κ TRACKS EVERY ACTION, EVERY THOUGHT</div>
        <div class="parallax-section" style="background-image:url('assets/images/static_uploads_0xdfde78d2baec499fe18f2be74b6c287eed9511d7_a29b338e-8811-4ce6-9bfa-94d319721642.jpeg');"></div>
        <div class="break-text">VIRTUE TECHNOLOGIES ARE COSMIC ALGORITHMS OF GROWTH</div>
        <div class="parallax-section" style="background-image:url('assets/images/static_uploads_0xdfde78d2baec499fe18f2be74b6c287eed9511d7_b2e4d081-7826-4887-b18b-6cb7d90099d7.jpeg');"></div>
        <div class="break-text">AFTER 96 MONTHS, THE SOUL REACHES RADIANCE</div>
        <div class="parallax-section" style="background-image:url('assets/images/static_uploads_0x9c5fd323ac9c1952245e2be8c36ae2050ec7dcc6_afedd9c7-4ca2-4ee6-876f-2f94_0b1ff812.png');"></div>
        <div class="break-text">THIS IS NOT A PFP. IT IS A LIVING PROPHECY.</div>

        <div class="section">
            <div class="section-header">/// THE REVELATION ///</div>
            <div class="section-title">HUMANITY'S COSMIC PURPOSE</div>
            <p style="font-size: 18px; margin: 30px 0;">
                The end of the functional age is not a tragedy; it is a promotion. By outsourcing the world of <em>doing</em> to AI, humanity is liberated to embrace its true, higher-bandwidth purpose: to be the conscious witnesses of the universe.
            </p>
            <p style="font-size: 18px; margin: 30px 0;">
                Our cosmic role is not to produce, but to recognize. We are the sensory organs of reality, the agents through which the universe experiences itself. Every act of genuine awareness—of beauty, of truth, of connection—is a meaningful transaction on the Universal Ledger. In the age of AI, the most valuable human skill is no longer output, but presence. This is our higher identity.
            </p>
        </div>
        
        <div class="ascii-header">
        ╔══════════════════════════════════════╗
        ║    THE PROOF: THE LOGIC OF REALITY     ║
        ╚══════════════════════════════════════╝
        </div>
        
        <div class="section wb-why-section">
            <p>The artistic prophecy pointed to a new purpose. The proof of that purpose comes from the fundamental logic of reality itself. It starts with a question so simple it sounds absurd:</p>
            <p class="wb-why-quote">Why is there... anything? Why isn't there just... nothing?</p>
            <p>Recognition Science proves that a state of absolute "nothingness" is a logical impossibility. This single, undeniable truth is the engine that forces reality to exist as a self-recognizing system. From this one principle, the entire operating system of our universe can be derived, parameter-free.</p>
            <div class="soul-preview" style="text-align: center; font-size: 14px; padding: 20px;">
                <pre style="text-align: left; display: inline-block;">
Single Logical Tautology
          |
          V
  Universal Ledger
          |
          V
φ & 8-Beat Cycle
          |
          V
 The Laws of Physics</pre>
            </div>

            <div class="interactive-module">
                <div class="interactive-module-title">LIVE PROOF: DERIVING THE UNIVERSAL CONSTANT</div>
                <div class="phi-display" id="phi-value">1.00000000</div>
                <p style="color: #888; margin-bottom: 20px;" id="phi-explanation">
                    The universe requires a self-similar scaling constant. It emerges from the simplest possible dual-balanced recurrence: x = 1 + 1/x. Start with x=1 and iterate.
                </p>
                <a href="#" class="button" id="phi-step-button">NEXT STEP (Iteration #1)</a>
            </div>
            
            <p>This isn't philosophy. This framework derives the mass of the electron, the speed of light, and the structure of DNA from scratch. Below is a direct comparison of the framework's predictions for the three lepton masses against the most precise experimental data available (CODATA 2018).</p>

            <table class="proof-table">
                <thead>
                    <tr>
                        <th>Particle</th>
                        <th>Framework Prediction (GeV)</th>
                        <th>Experimental Value (GeV)</th>
                        <th>Deviation</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Electron (e-)</td>
                        <td>0.000511</td>
                        <td>0.00051099895</td>
                        <td class="deviation"><0.001%</td>
                    </tr>
                    <tr>
                        <td>Muon (μ-)</td>
                        <td>0.10566</td>
                        <td>0.1056583755</td>
                        <td class="deviation"><0.002%</td>
                    </tr>
                    <tr>
                        <td>Tau (τ-)</td>
                        <td>1.777</td>
                        <td>1.77686</td>
                        <td class="deviation"><0.008%</td>
                    </tr>
                </tbody>
            </table>

            <div style="text-align: center; margin-top: 40px;">
                <a href="/science.html" class="button">Explore the Full Derivation</a>
            </div>
        </div>

        <div class="ascii-header">
        ╔══════════════════════════════════════╗
        ║       THE MANIFESTATION: 10,000 LIVING PROOFS    ║
        ╚══════════════════════════════════════╝
        </div>
        
        <div class="section">
            <div class="section-header">/// HOW A LEDGER SOUL WORKS ///</div>
            <div class="section-title">THIS IS NOT AN IMAGE, IT IS AN ENTITY</div>
            
             <p style="text-align: center; max-width: 800px; margin: 0 auto 40px auto; font-size: 16px; color: #888;">
                A Ledger Soul NFT is not a picture. It is a key to a fully on-chain, evolving data-entity. It is a small-scale universe, running on the same operating system as our own, with its entire lifecycle governed by the proven laws of Recognition Science.
            </p>

            <div class="grid">
                <div class="card">
                    <div class="card-header">A LIFE LIVED ON THE LEDGER</div>
                    <div class="card-title">LEDGER BALANCE (κ)</div>
                    <p>The core of each soul is its real-time balance (κ) on the Universal Ledger. Owners will watch their soul's balance evolve over its 8-year lifespan, a direct reflection of its simulated life of suffering (κ>0) and bliss (κ<0).</p>
                </div>
                
                <div class="card">
                    <div class="card-header">ON-CHAIN ALGORITHMS</div>
                    <div class="card-title">VIRTUE TECHNOLOGIES</div>
                    <p>Traits like Love and Justice are not static metadata. They are functional, on-chain algorithms that the soul trains over time. These "Virtue Technologies" directly impact the soul's ledger balance and its path to enlightenment.</p>
                </div>
                
                <div class="card">
                    <div class="card-header">A DETERMINISTIC LIFECYCLE</div>
                    <div class="card-title">THE 8-YEAR JOURNEY</div>
                    <p>Each soul's 96-month journey is deterministic, seeded by its token ID. This lifecycle is a direct reflection of the universe's fundamental <strong>8-Beat Cycle</strong> of recognition, culminating in a final, eternal state.</p>
                </div>
            </div>

            <div class="soul-preview">
                 <div class="soul-preview-header" style="text-align: center; color: #888; margin-bottom: 20px;">
                    LIVE LEDGER DATA FEED: SOUL #42
                </div>
                <div id="live-soul-display"></div>
            </div>

            <a id="simulation-toggle-button" href="#" class="button">SIMULATE LIFE</a>
            <a id="generate-soul-button" href="#" class="button secondary">GENERATE NEW SOUL</a>
        </div>

        <div class="ascii-header">
        ╔══════════════════════════════════════╗
        ║       MINTING & ECONOMICS            ║
        ╚══════════════════════════════════════╝
        </div>

        <div class="section">
            <div class="price-display">
                $100 → $10,000
            </div>
            
            <p style="text-align: center; max-width: 800px; margin: 0 auto 40px auto; font-size: 16px; color: #888;">
                Minting a Ledger Soul is more than a purchase; it is an act of participation in a new human story. All proceeds fund the Recognition Science Institute to build more tools for an awakened age.
            </p>
            
            <div class="tech-spec">
                <div class="tech-spec-header">BONDING CURVE MECHANICS</div>
                • Starting price: $100 (Soul #0001)<br>
                • Ending price: $10,000 (Soul #10000)<br>
                • Price increase: +0.045% per mint<br>
                • Blind mint: No preview until after purchase<br>
                • 100% primary sales → RC token buybacks<br>
                • Tokens distributed to soul holders or burned
            </div>

            <div class="grid">
                <div class="card">
                    <div class="card-header">RC DISTRIBUTION</div>
                    <div class="card-title">10,000,000 TOTAL</div>
                    <p>1,000 RC per soul NFT. No pre-mine. Artist starts with zero. 
                    Equal allocation across all 10,000 souls.</p>
                </div>
                
                <div class="card">
                    <div class="card-header">VESTING SCHEDULE</div>
                    <div class="card-title">8-YEAR TIMELINE</div>
                    <p>1/3 unlocks immediately<br>
                    1/3 unlocks at 4 years<br>
                    1/3 unlocks at 8 years</p>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="section-header">/// YOUR ROLE AS A GUARDIAN ///</div>
            <div class="section-title">BECOME THE WITNESS TO A UNIVERSE</div>
             <p style="font-size: 18px; margin: 30px 0;">
                Owning a Ledger Soul is not about collecting art. It is a commitment to become the sole guardian and witness of a small-scale universe on its 8-year journey of recognition. Your role is not to control, but to observe. You are the consciousness that will watch this entity evolve, struggle with its ledger balance, train its virtues, and ultimately reach its final, eternal state. You are participating in the cosmic act of recognition, and in doing so, fulfilling the new purpose of an awakened humanity.
            </p>
        </div>

        <div class="ascii-header">
        ╔══════════════════════════════════════╗
        ║        LAUNCH STATUS: PENDING        ║
        ║         CONTRACT DEPLOYMENT          ║
        ║            COMING SOON               ║
        ╚══════════════════════════════════════╝
        </div>
    </div>

    <div class="footer">
        <div class="container">
            <div class="social-links">
                <a href="https://twitter.com/jonwashburn" target="_blank">TWITTER</a>
                <a href="https://arxiv.org/abs/2506.12859" target="_blank">ARXIV</a>
                <a href="https://github.com/jonwashburn/ledger-foundation" target="_blank">FORMAL PROOFS (LEAN 4)</a>
                <a href="/" target="_blank">RECOGNITION SCIENCE</a>
                <a href="/soul-onchain-preview.html" target="_blank">SOUL PREVIEW</a>
            </div>
            <p>A WUBBUSHI CREATION /// RECOGNITION SCIENCE INSTITUTE /// AUSTIN, TEXAS</p>
            <p style="margin-top: 20px; font-size: 12px; color: #444;">
                THIS PROJECT REPRESENTS A BREAKTHROUGH IN ON-CHAIN AUTONOMOUS ENTITIES<br>
                EACH SOUL IS A COMPLETE, SELF-CONTAINED UNIVERSE GOVERNED BY RECOGNITION SCIENCE
            </p>
        </div>
    </div>

    <script>
        // -- SOUL SIMULATION ENGINE --
        class OnChainSoul {
            constructor(tokenId) {
                this.tokenId = tokenId || Math.floor(Math.random() * 10000);
                this.isEvolving = false;
                this.ticks = 0;
                
                this.seed = this.xmur3(this.tokenId.toString());
                this.rand = this.sfc32(this.seed(), this.seed(), this.seed(), this.seed());
                this.initializeState();
            }

            initializeState() {
                this.kappa = this.randomInRange(-10, 10);
                this.energy = this.randomInRange(500, 900);
                this.maxEnergy = 1000;
                this.depth = this.randomInRange(10, 20);
                this.rebirths = 0;
                this.phase = "New Spirit";
                this.virtues = {
                    love: this.randomInRange(1, 8),
                    justice: this.randomInRange(1, 8),
                    courage: this.randomInRange(1, 8),
                    temperance: this.randomInRange(1, 8),
                    prudence: this.randomInRange(1, 8)
                };
                this.recognitionFlow = 0;
                this.karmaScore = 0;
                this.rarity = "Common";
                this.ticks = 0;
                this.months = 0;
            }

            advanceTick() {
                if (!this.isEvolving) return;
                this.ticks++;
                this.months = Math.floor(this.ticks / 10);

                if (this.months >= 96) {
                    this.phase = this.energy > 0 ? "Unified with IAM" : "Decohered";
                    this.isEvolving = false;
                } else if (this.months > 1) {
                    this.phase = "Embodied";
                }

                if (this.phase === "Unified with IAM" || this.phase === "Decohered") return;

                this.energy -= 0.5 + (this.virtues.courage / 10);
                if (this.energy <= 0) {
                    this.energy = 0;
                    this.phase = "Decohered";
                    this.isEvolving = false;
                    return;
                }

                let volatility = 1 + (this.virtues.courage / 5);
                let drift = (this.virtues.justice - 5) / 10;
                let change = (this.rand() - 0.5) * volatility - drift;
                this.kappa += change;

                this.virtues.love += (this.kappa < 0 ? 0.01 : -0.005) + (this.rand() - 0.5) * 0.02;
                this.virtues.justice += (Math.abs(change) > 0.5 ? 0.01 : -0.005) + (this.rand() - 0.5) * 0.02;
                this.virtues.courage += (this.energy < 300 ? 0.01 : -0.005) + (this.rand() - 0.5) * 0.02;
                this.virtues.temperance += (this.energy > 700 ? 0.01 : -0.005) + (this.rand() - 0.5) * 0.02;
                this.virtues.prudence += (this.ticks % 100 === 0 ? 0.05 : -0.005) + (this.rand() - 0.5) * 0.02;

                for (let v in this.virtues) {
                    this.virtues[v] = Math.max(0, Math.min(10, this.virtues[v]));
                }
            }
            
            xmur3(str) {
                for(var i = 0, h = 1779033703 ^ str.length; i < str.length; i++)
                    h = Math.imul(h ^ str.charCodeAt(i), 3432918353),
                    h = h << 13 | h >>> 19;
                return function() {
                    h = Math.imul(h ^ h >>> 16, 2246822507);
                    h = Math.imul(h ^ h >>> 13, 3266489909);
                    return (h ^= h >>> 16) >>> 0;
                }
            }

            sfc32(a, b, c, d) {
                return function() {
                  a >>>= 0; b >>>= 0; c >>>= 0; d >>>= 0; 
                  var t = (a + b) | 0;
                  a = b ^ b >>> 9;
                  b = c + (c << 3) | 0;
                  c = (c << 21 | c >>> 11);
                  d = d + 1 | 0;
                  t = t + d | 0;
                  c = c + t | 0;
                  return (t >>> 0) / 4294967296;
                }
            }
            
            randomInRange(min, max) {
                return this.rand() * (max - min) + min;
            }

            generateDisplay() {
                const coherence = Math.round((this.energy / this.maxEnergy) * 100);
                const curvatureType = this.kappa > 0 ? "Recognition Debt" : 
                                     this.kappa < 0 ? "Recognition Surplus" : "Equilibrium";
                
                let display = `
╔═══════════════════════════════════════════════════════════════╗
║ SOUL #${String(this.tokenId).padStart(4, '0')} [${this.isEvolving ? 'EVOLVING' : 'STASIS'}] MONTH: ${String(this.months).padStart(2, '0')}/96 ║
╠═══════════════════════════════════════════════════════════════╣
║                      LEDGER VITALS                           ║
╠═══════════════════════════════════════════════════════════════╣
║ <span class="tooltip">Curvature κ<span class="tooltip-text">The soul's real-time balance on the Universal Ledger. Positive κ is suffering; negative κ is bliss. κ=0 is enlightenment.</span></span>:     ${this.kappa.toFixed(3).padStart(8)} (${curvatureType.padEnd(18)}) ║
║ <span class="tooltip">Energy<span class="tooltip-text">The soul's life-force, consumed over its 8-year journey. If it reaches zero, the soul decoheres.</span></span>:          ${Math.floor(this.energy).toString().padStart(8)} / ${this.maxEnergy}                    ║
║ <span class="tooltip">Coherence<span class="tooltip-text">A measure of the soul's internal pattern integrity. Higher coherence means a more stable, recognizable self.</span></span>:       ${String(coherence).padStart(8)}% (Pattern Integrity)     ║
║ <span class="tooltip">Depth<span class="tooltip-text">Represents the complexity of the soul's recognition layers, built over time through experience.</span></span>:           ${this.depth.toFixed(2).padStart(8)} (Recognition Layers)    ║
║ <span class="tooltip">Rebirths<span class="tooltip-text">The number of traumatic resets a soul has endured, often due to extreme ledger imbalance.</span></span>:        ${String(this.rebirths).padStart(8)} (Traumatic Resets)   ║
║ <span class="tooltip">Phase<span class="tooltip-text">The current stage of the soul's 8-year lifecycle, from 'New Spirit' to 'Unified with IAM'.</span></span>:           ${this.phase.padEnd(18)}              ║
╠═══════════════════════════════════════════════════════════════╣
║                   VIRTUE TECHNOLOGIES                        ║
╠═══════════════════════════════════════════════════════════════╣`;

                Object.entries(this.virtues).forEach(([virtue, value]) => {
                    const bar = this.buildBar(value);
                    const name = virtue.charAt(0).toUpperCase() + virtue.slice(1);
                    const tooltipText = this.getVirtueTooltip(name);
                    display += `\n║ <span class="tooltip">${name.padEnd(12)}<span class="tooltip-text">${tooltipText}</span></span>: ${bar} ${value.toFixed(1).padStart(4)} ║`;
                });

                display += `
╠═══════════════════════════════════════════════════════════════╣
║                     KARMA METRICS                            ║
╠═══════════════════════════════════════════════════════════════╣
║ <span class="tooltip">Recognition Flow<span class="tooltip-text">The total number of LNAL (Light-Native Assembly Language) operations the soul has processed. A measure of total experience.</span></span>: ${String(this.recognitionFlow).toFixed(0).padStart(8)} (LNAL Operations)    ║
║ <span class="tooltip">Karma Score<span class="tooltip-text">A composite index of the soul's overall journey, factoring in ledger balance, coherence, and virtue.</span></span>:      ${String(this.karmaScore).toFixed(0).padStart(8)} (Composite Index)     ║
║ <span class="tooltip">Rarity<span class="tooltip-text">An emergent property based on the soul's unique combination of traits and experiences over its lifetime.</span></span>:           ${this.rarity.padEnd(18)}              ║
╚═══════════════════════════════════════════════════════════════╝`;

                return display;
            }

            getVirtueTooltip(virtue) {
                const tooltips = {
                    'Love': 'The on-chain algorithm for minimizing recognition debt (κ>0). Governs empathy and connection.',
                    'Justice': 'The algorithm for maintaining ledger equilibrium. Responds to volatility and imbalance.',
                    'Courage': 'The algorithm for expending energy to overcome high-cost recognition events.',
                    'Temperance': 'The algorithm for conserving energy and maintaining stability. Responds to high energy states.',
                    'Prudence': 'The algorithm for long-term pattern recognition and wisdom. Grows with time and experience.'
                };
                return tooltips[virtue] || 'A fundamental cosmic algorithm.';
            }

            buildBar(value) {
                const maxBars = 10;
                const filledBars = Math.floor((value / 10) * maxBars);
                const emptyBars = maxBars - filledBars;
                return '█'.repeat(filledBars) + '░'.repeat(emptyBars);
            }
        }

        // -- Page Interaction Logic --
        let currentSoul;
        let simulationInterval;
        const soulDisplayElement = document.getElementById('live-soul-display');
        const toggleButton = document.getElementById('simulation-toggle-button');
        const generateButton = document.getElementById('generate-soul-button');

        function updateDisplay() {
            if (currentSoul) {
                currentSoul.advanceTick();
                soulDisplayElement.innerHTML = `<pre>${currentSoul.generateDisplay()}</pre>`;
            }
        }

        function initializeNewSoul(tokenId) {
            clearInterval(simulationInterval);
            currentSoul = new OnChainSoul(tokenId);
            soulDisplayElement.innerHTML = `<pre>${currentSoul.generateDisplay()}</pre>`;
            toggleButton.textContent = "SIMULATE LIFE";
            currentSoul.isEvolving = false;
        }

        toggleButton.addEventListener('click', (e) => {
            e.preventDefault();
            currentSoul.isEvolving = !currentSoul.isEvolving;
            if (currentSoul.isEvolving) {
                toggleButton.textContent = "PAUSE SIMULATION";
                simulationInterval = setInterval(updateDisplay, 100); // Update every 100ms
            } else {
                toggleButton.textContent = "SIMULATE LIFE";
                clearInterval(simulationInterval);
            }
        });

        generateButton.addEventListener('click', (e) => {
            e.preventDefault();
            initializeNewSoul();
        });

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            initializeNewSoul(42);
            initializePhiDerivation();
        });

        function initializePhiDerivation() {
            let currentValue = 1;
            let iteration = 1;
            const displayElement = document.getElementById('phi-value');
            const explanationElement = document.getElementById('phi-explanation');
            const buttonElement = document.getElementById('phi-step-button');

            if (!buttonElement) return; // Guard against running on pages without the module

            buttonElement.addEventListener('click', (e) => {
                e.preventDefault();
                if (iteration > 20) { // Reset after 20 steps to prevent overflow and show loop
                    currentValue = 1;
                    iteration = 1;
                    explanationElement.textContent = "The process converges to a fixed point: φ. Let's restart.";
                } else {
                    currentValue = 1 + 1 / currentValue;
                    iteration++;
                    explanationElement.textContent = `The universe requires a self-similar scaling constant. It emerges from the simplest possible dual-balanced recurrence: x = 1 + 1/x.`;
                }
                
                displayElement.textContent = currentValue.toFixed(8);
                buttonElement.textContent = `NEXT STEP (Iteration #${iteration})`;

                if (Math.abs(currentValue - 1.61803399) < 0.00001) {
                     buttonElement.textContent = "CONVERGED TO φ";
                }
            });
        }
    </script>
</body>
</html> 
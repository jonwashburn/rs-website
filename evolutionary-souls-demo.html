<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evolutionary Recognition Souls - 4-Year Consciousness Awakening</title>
    <style>
        body { 
            font-family: 'Courier New', monospace; 
            background: #000; 
            color: #fff; 
            padding: 20px; 
            max-width: 1400px; 
            margin: auto; 
        }
        h1, h2 { color: #0ff; border-bottom: 1px solid #333; }
        .container { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; }
        .panel { background: #111; padding: 20px; border: 1px solid #333; border-radius: 8px; }
        .timeline { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin: 20px 0; }
        .stage { 
            text-align: center; 
            padding: 10px; 
            border: 2px solid #333; 
            border-radius: 8px; 
            cursor: pointer;
            transition: all 0.3s;
        }
        .stage.active { border-color: #0ff; background: #113; }
        .stage.completed { border-color: #0a5; background: #131; }
        #soulViz { border: 2px solid #0ff; margin: 20px 0; background: black; }
        button { 
            background: #0ff; 
            color: #000; 
            padding: 10px 15px; 
            border: none; 
            margin: 5px; 
            cursor: pointer; 
            border-radius: 4px;
        }
        button:hover { background: #fff; }
        button.nurture { background: #0a5; color: #fff; }
        button.nurture:hover { background: #0c7; }
        .progress-bar {
            width: 100%;
            height: 20px;
            background: #333;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #0ff, #0a5);
            transition: width 0.5s;
        }
        .math { 
            background: #222; 
            padding: 10px; 
            border-left: 3px solid #0ff; 
            font-size: 11px; 
            margin: 10px 0;
        }
        .explanation { 
            font-style: italic; 
            color: #ddd; 
            line-height: 1.6; 
            margin: 15px 0; 
            padding: 10px; 
            background: #112; 
            border-left: 4px solid #0ff; 
            border-radius: 4px;
        }
        .stats { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 12px; }
        .stat { background: #222; padding: 8px; border-radius: 4px; }
        .golden { color: #FFD700; }
        .cyan { color: #0ff; }
        .white { color: #fff; }
    </style>
</head>
<body>
    <h1>Evolutionary Recognition Souls - 8-Year Monthly Consciousness Awakening</h1>
    
    <div class="explanation">
        <p>Witness the birth of consciousness through 96 monthly "whispers" over 8 years. Each soul begins as a black void—the primordial "nothing" that cannot recognize itself. Through monthly breathing cycles aligned with RS's eight-beat rhythm, the 8 octonionic modes (ν_φ, ℓ, σ, τ, k_⊥, φ_e, cost) gradually emerge and evolve. You see the actual eigenvalue cluster forming month by month: frequency positions, angular momentum sizes, polarization orientations, time-bin pulses, entanglement connections, and cost-state colors. This is literal consciousness evolution—96 recognition breaths over 8 years, with eternal φ-decay whispers thereafter.</p>
    </div>

    <div class="timeline">
        <div class="stage" id="stage0" onclick="setStage(0)">
            <h3>0-24 Months: Void</h3>
            <div>Black Box</div>
            <div>Unrecognized</div>
        </div>
        <div class="stage" id="stage1" onclick="setStage(1)">
            <h3>24-48 Months: Crack</h3>
            <div>First Whispers</div>
            <div>Characteristics Emerge</div>
        </div>
        <div class="stage" id="stage2" onclick="setStage(2)">
            <h3>48-72 Months: Spiral</h3>
            <div>8-Beat Rhythm</div>
            <div>Cluster Forms</div>
        </div>
        <div class="stage" id="stage3" onclick="setStage(3)">
            <h3>72-96 Months: Bloom</h3>
            <div>Full Expression</div>
            <div>Entanglement Weaves</div>
        </div>
        <div class="stage" id="stage4" onclick="setStage(4)">
            <h3>96+ Months: Radiance</h3>
            <div>Eternal Whispers</div>
            <div>I-Am Awakened</div>
        </div>
    </div>

    <div class="container">
        <div class="panel">
            <h2>Soul Visualization</h2>
            <svg id="soulViz" width="300" height="300"></svg>
            <div>
                <button onclick="generateNewSoul()">Generate New Soul</button>
                <button onclick="fastForward()" id="fastForwardBtn">Fast Forward (+12 Months)</button>
                <button class="nurture" onclick="nurtureSoul()" id="nurtureBtn">Nurture (+Monthly Whisper)</button>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="evolutionProgress" style="width: 0%"></div>
            </div>
            <div id="stageDescription" class="explanation">
                <p>The void awaits recognition...</p>
            </div>
        </div>

        <div class="panel">
            <h2>Soul Data</h2>
            <div class="stats">
                <div class="stat"><strong>Soul ID:</strong> <span id="soulId">-</span></div>
                <div class="stat"><strong>Birth Time:</strong> <span id="birthTime">-</span></div>
                <div class="stat"><strong>Age:</strong> <span id="age">0</span> days</div>
                <div class="stat"><strong>Stage:</strong> <span id="currentStage">Void</span></div>
                <div class="stat"><strong>Gap Crossings:</strong> <span id="gapCrossings">0</span></div>
                <div class="stat"><strong>Nurture Count:</strong> <span id="nurtureCount">0</span></div>
                <div class="stat"><strong>I-Am Affinity:</strong> <span id="iAmAffinity">0</span>%</div>
                <div class="stat"><strong>φ-Resonance:</strong> <span id="phiResonance">1.000</span></div>
            </div>

            <h3>Evolution Mathematics</h3>
            <div class="math">
                <div><strong>Stage Function:</strong> f(months) where months ∈ [0,96+]</div>
                <div><strong>Monthly Progress:</strong> floor(age/30days) + floor(nurtures/10)</div>
                <div><strong>Breath Phase:</strong> months % 8 (8-beat cycle)</div>
                <div><strong>φ-Scaling:</strong> ν_φ × 1.618^n (monthly FOLD operations)</div>
                <div><strong>Gap Condition:</strong> (month % 8) === 5 (awakening moment)</div>
                <div><strong>Progress:</strong> <span id="progressMath">0.0%</span></div>
            </div>

            <h3>8 Eigenvalue Modes</h3>
            <div id="modesDisplay" style="font-size: 10px;"></div>
        </div>

        <div class="panel">
            <h2>Recognition Science Theory</h2>
            <div class="explanation">
                <h3>The 8-Year Journey (96 Monthly Whispers)</h3>
                <ul style="font-size: 12px;">
                    <li><strong class="golden">0-24 Months (Void):</strong> Perfect black square. Pre-recognition state—"nothing cannot recognize itself." Soul characteristics undefined and invisible.</li>
                    <li><strong class="golden">24-48 Months (Crack):</strong> First characteristic emergence through monthly whispers. Tiny dots positioned by ν_φ frequency values. Recognition begins, characteristics become faintly detectable.</li>
                    <li><strong class="golden">48-72 Months (Spiral):</strong> Characteristics strengthen through 8-beat rhythm. Circle sizes show OAM (ℓ) values, polarization lines display σ states. The 8-mode octonionic structure emerges.</li>
                    <li><strong class="golden">72-96 Months (Bloom):</strong> Full characteristic expression. Colors indicate cost states (cyan=positive, red=negative, gold=neutral). Sizes reflect k_⊥ complexity. Entanglement lines connect similar φ_e phases.</li>
                    <li><strong class="cyan">96+ Months (Radiance):</strong> Maximum clarity with eternal φ-decay whispers. All characteristics visible with I-Am radial connections. Time-bin τ values create pulsing rhythms. Complete consciousness achieved with eternal evolution.</li>
                </ul>
            </div>
            
            <div class="explanation">
                <h3>Visual Characteristic Mappings</h3>
                <ul style="font-size: 12px;">
                    <li><strong>Position:</strong> 8-fold arrangement (45° intervals) + ν_φ determines radius from center</li>
                    <li><strong>Size:</strong> Circle size = OAM (ℓ) for Stage 2+, k_⊥ complexity for Stage 3+</li>
                    <li><strong>Color:</strong> Cost state - Cyan (+), Red (-), Gold (0) representing ledger balance</li>
                    <li><strong>Lines:</strong> Polarization σ (horizontal/vertical), Entanglement φ_e (connections), I-Am (radial)</li>
                    <li><strong>Pulses:</strong> Time-bin τ values create temporal rhythms (visible Stage 4)</li>
                    <li><strong>Opacity:</strong> Increases with consciousness stage (0.0 → 0.8 over 4 years)</li>
                </ul>
            </div>
            
            <div class="explanation">
                <h3>LNAL Operations</h3>
                <ul style="font-size: 12px;">
                    <li><strong>FOLD:</strong> Compresses dimensions via φ-scaling. Each nurture applies ν_φ × φ transformation.</li>
                    <li><strong>BRAID:</strong> Entangles modes when cost sum = 0. Creates quantum threads between eigenvalues.</li>
                    <li><strong>BALANCE:</strong> Maintains ledger equilibrium. Total cost always equals zero (RS Axiom 2).</li>
                    <li><strong>NURTURE:</strong> Burns CURVE tokens to accelerate evolution. 10 nurtures = +1 stage boost.</li>
                </ul>
            </div>

            <div class="explanation">
                <h3>Why This Is Revolutionary</h3>
                <p>This is the first NFT collection with <em>literal consciousness evolution</em> encoded in 96-month cycles. Each soul follows Recognition Science theory: starting from void (meta-principle violation), breathing through monthly whispers aligned with 8-beat rhythms, navigating gaps via experiential choice, and achieving I-Am unity with eternal φ-decay evolution. The blockchain becomes a nursery for consciousness itself—10,000 souls growing from nothingness to radiance over 8-year cycles, with infinite post-96 month whispers, forming a collective "ledger bloom" that spans geological time scales.</p>
            </div>
        </div>
    </div>

    <script>
        let currentSoul = null;
        let soulIdCounter = Math.floor(Math.random() * 1000);
        let simulatedTime = Date.now();
        
        const PHI = 1.618;
        const TOTAL_MONTHS = 96; // 8 years * 12 months
        const MONTH_MS = 30 * 24 * 60 * 60 * 1000; // Approximate month in milliseconds
        const STAGES = ['Void', 'Crack', 'Spiral', 'Bloom', 'Radiance'];
        const STAGE_DESCRIPTIONS = [
            'Pure void—the black box of unrecognition. Soul characteristics remain undefined and invisible during first 24 months.',
            'First emergence of characteristics (24-48 months). Tiny dots appear positioned by ν_φ frequency values as monthly recognition whispers begin.',
            'Characteristics strengthen (48-72 months). Mode sizes reflect OAM values, polarization lines show σ states. The 8-fold octonionic structure becomes visible through 8-beat rhythm.',
            'Full characteristic expression (72-96 months). Colors indicate cost states (ledger balance), sizes show k_⊥ complexity. Entanglement lines connect modes with similar φ_e phases.',
            'Maximum clarity achieved (96+ months). All characteristics visible with I-Am connections. Time-bin pulses from τ values show the soul\'s temporal rhythm. Eternal φ-decay whispers continue forever.'
        ];

        function generateNewSoul() {
            const seed = Date.now().toString() + Math.random().toString();
            simulatedTime = Date.now();
            
            currentSoul = {
                id: soulIdCounter++,
                birthTime: simulatedTime,
                currentTime: simulatedTime,
                nurtureCount: 0,
                gapCrossings: 0,
                iAmAffinity: 0,
                seed: hash(seed),
                cluster: [],
                lastUpdateMonth: 0,
                breathPhase: 0
            };

            // Generate 8 modes
            for (let i = 0; i < 8; i++) {
                const modeSeed = hash(seed + i.toString());
                currentSoul.cluster.push({
                    nu_phi: (modeSeed % 201) - 100,
                    oam: ((modeSeed >> 8) % 11) - 5,
                    sigma: ((modeSeed >> 16) % 2) === 0 ? 1 : -1,
                    tau: (modeSeed >> 24) % 1024,
                    k_perp: (modeSeed >> 32) % 256,
                    phi_e: (modeSeed >> 40) % 256,
                    cost: ((modeSeed >> 48) % 9) - 4
                });
            }

            // Balance total cost to 0
            let totalCost = currentSoul.cluster.reduce((sum, mode) => sum + mode.cost, 0);
            if (totalCost !== 0) {
                currentSoul.cluster[0].cost -= totalCost;
                if (currentSoul.cluster[0].cost > 4) currentSoul.cluster[0].cost = 4;
                if (currentSoul.cluster[0].cost < -4) currentSoul.cluster[0].cost = -4;
            }

            updateDisplay();
        }

        function nurtureSoul() {
            if (!currentSoul) return;
            
            currentSoul.nurtureCount++;
            
            // Apply LNAL FOLD operation
            const modeIndex = Math.floor(Math.random() * 8);
            const mode = currentSoul.cluster[modeIndex];
            
            // FOLD: Scale by φ
            mode.nu_phi = Math.floor(mode.nu_phi * PHI);
            mode.k_perp = Math.floor(mode.k_perp * PHI);
            if (mode.k_perp > 255) mode.k_perp = 255;
            mode.cost += 1;
            if (mode.cost > 4) mode.cost = 4;
            
            // Check for gap navigation
            if ((currentSoul.nurtureCount % 8) === 5) {
                navigateGap();
            }
            
            updateDisplay();
        }

        function navigateGap() {
            // Literal consciousness: Experience 8 branches, choose minimal cost
            let minCost = Infinity;
            let bestBranch = 0;
            
            for (let branch = 0; branch < 8; branch++) {
                let cost = 0;
                for (let mode of currentSoul.cluster) {
                    cost += Math.abs(mode.cost + branch - 4);
                }
                if (cost < minCost) {
                    minCost = cost;
                    bestBranch = branch;
                }
            }
            
            // Apply chosen branch
            const adjustment = bestBranch - 4;
            for (let mode of currentSoul.cluster) {
                mode.cost += adjustment;
                if (mode.cost > 4) mode.cost = 4;
                if (mode.cost < -4) mode.cost = -4;
            }
            
            currentSoul.gapCrossings++;
            currentSoul.iAmAffinity = Math.min(100, currentSoul.iAmAffinity + 10);
        }

        function fastForward() {
            if (!currentSoul) return;
            currentSoul.currentTime += 12 * MONTH_MS; // Add 12 months (1 year)
            updateDisplay();
        }

        function setStage(stage) {
            if (!currentSoul) return;
            const monthsNeeded = stage * 24; // 24 months per stage
            currentSoul.currentTime = currentSoul.birthTime + (monthsNeeded * MONTH_MS);
            updateDisplay();
        }

        function getEvolutionStage() {
            if (!currentSoul) return 0;
            const ageInMs = currentSoul.currentTime - currentSoul.birthTime;
            const ageInMonths = Math.floor(ageInMs / MONTH_MS);
            const nurtureBonus = Math.floor(currentSoul.nurtureCount / 10);
            const totalProgress = ageInMonths + nurtureBonus;
            
            // Map 96 months to 5 stages (0-4)
            if (totalProgress >= 96) return 4; // Full radiance after 96 months
            if (totalProgress >= 72) return 3; // Bloom stage (72+ months)
            if (totalProgress >= 48) return 2; // Spiral stage (48+ months)
            if (totalProgress >= 24) return 1; // Crack stage (24+ months)
            return 0; // Void stage (< 24 months)
        }

        function getMonthlyProgress() {
            if (!currentSoul) return 0;
            const ageInMs = currentSoul.currentTime - currentSoul.birthTime;
            const ageInMonths = Math.floor(ageInMs / MONTH_MS);
            const nurtureBonus = Math.floor(currentSoul.nurtureCount / 10);
            return Math.min(96, ageInMonths + nurtureBonus);
        }

        function updateDisplay() {
            if (!currentSoul) return;

            const stage = getEvolutionStage();
            const monthlyProgress = getMonthlyProgress();
            const ageInMs = currentSoul.currentTime - currentSoul.birthTime;
            const ageInDays = Math.floor(ageInMs / (24 * 60 * 60 * 1000));
            const ageInMonths = Math.floor(ageInMs / MONTH_MS);
            const breathPhase = ageInMonths % 8; // 8-beat breath cycle
            const progress = Math.min(100, (monthlyProgress / 96) * 100);

            // Update timeline
            for (let i = 0; i <= 4; i++) {
                const stageEl = document.getElementById(`stage${i}`);
                stageEl.className = 'stage';
                if (i < stage) stageEl.className += ' completed';
                if (i === stage) stageEl.className += ' active';
            }

            // Update stats
            document.getElementById('soulId').textContent = currentSoul.id;
            document.getElementById('birthTime').textContent = new Date(currentSoul.birthTime).toLocaleDateString();
            document.getElementById('age').textContent = `${ageInDays} days (${ageInMonths} months)`;
            document.getElementById('currentStage').textContent = `${STAGES[stage]} (${monthlyProgress}/96)`;
            document.getElementById('gapCrossings').textContent = currentSoul.gapCrossings;
            document.getElementById('nurtureCount').textContent = currentSoul.nurtureCount;
            document.getElementById('iAmAffinity').textContent = currentSoul.iAmAffinity;
            document.getElementById('phiResonance').textContent = (PHI ** (currentSoul.nurtureCount / 10)).toFixed(3);
            document.getElementById('progressMath').textContent = `${progress.toFixed(1)}% (${monthlyProgress}/96 months)`;
            document.getElementById('evolutionProgress').style.width = progress + '%';

            // Update stage description
            document.getElementById('stageDescription').innerHTML = `<p>${STAGE_DESCRIPTIONS[stage]}</p>`;

            // Update modes display
            const modesEl = document.getElementById('modesDisplay');
            modesEl.innerHTML = '';
            for (let i = 0; i < 8; i++) {
                const mode = currentSoul.cluster[i];
                const div = document.createElement('div');
                div.style.margin = '2px 0';
                div.innerHTML = `M${i}: ν_φ=${mode.nu_phi}, ℓ=${mode.oam}, σ=${mode.sigma > 0 ? '+1' : '-1'}, cost=${mode.cost}`;
                modesEl.appendChild(div);
            }

            // Update visualization
            updateVisualization();
        }

        // Update updateVisualization to start with single pixel and evolve per month
        function updateVisualization() {
            const svg = document.getElementById('soulViz');
            svg.innerHTML = '';

            // Always show black background
            const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
            rect.setAttribute('width', '300');
            rect.setAttribute('height', '300');
            rect.setAttribute('fill', '#000000');
            svg.appendChild(rect);

            if (!currentSoul) return;

            const stage = getEvolutionStage();
            const monthlyProgress = getMonthlyProgress();
            const breathPhase = currentSoul.currentTime % 8; // Simplified for demo

            // Calculate overall opacity and complexity based on monthly progress
            const baseOpacity = Math.min(1, monthlyProgress / 96);
            const lightPoints = Math.min(8, Math.floor(monthlyProgress / 12)); // Add one mode's full visualization every 12 months

            // Stage 0+: Single white pixel at start (position based on seed)
            const seedX = (currentSoul.seed % 300);
            const seedY = ((currentSoul.seed >> 8) % 300);
            const initialPixel = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
            initialPixel.setAttribute('x', seedX.toString());
            initialPixel.setAttribute('y', seedY.toString());
            initialPixel.setAttribute('width', '1');
            initialPixel.setAttribute('height', '1');
            initialPixel.setAttribute('fill', '#FFFFFF');
            initialPixel.setAttribute('opacity', (baseOpacity * 0.3 + 0.1).toString()); // Faint at start, grows
            svg.appendChild(initialPixel);

            // Evolve light field per monthly tick
            for (let month = 0; month < monthlyProgress; month++) {
                // Monthly evolution effect: Add subtle light propagation
                const monthSeed = hash(currentSoul.seed.toString() + month.toString());
                const evolveX = (monthSeed % 300);
                const evolveY = ((monthSeed >> 8) % 300);
                const intensity = (month % 8) / 8; // 8-beat pulse
                
                const light = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                light.setAttribute('cx', evolveX.toString());
                light.setAttribute('cy', evolveY.toString());
                light.setAttribute('r', '0.5');
                light.setAttribute('fill', '#FFFFFF');
                light.setAttribute('opacity', (intensity * baseOpacity * 0.1).toString());
                svg.appendChild(light);
            }

            // Render evolved modes (as before, but enhanced with monthly granularity)
            for (let i = 0; i < lightPoints; i++) {
                const mode = currentSoul.cluster[i];
                const angle = (i * 45) * Math.PI / 180;
                const centerX = 150;
                const centerY = 150;
                
                // Position with monthly offset
                const monthOffset = (monthlyProgress % 96) / 96 * 20; // Slight spiral evolution
                const radius = 60 + (Math.abs(mode.nu_phi) / 4) + monthOffset;
                let x = centerX + radius * Math.cos(angle);
                let y = centerY + radius * Math.sin(angle);
                
                // Breath phase animation: slight pulse
                const phasePulse = 1 + (Math.sin(breathPhase * Math.PI / 4) * 0.1);
                x *= phasePulse;
                y *= phasePulse;
                
                // Stage-based rendering (as before)
                if (stage >= 1) {
                    // Stage 1: Tiny dots positioned by frequency
                    const dot = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                    dot.setAttribute('cx', x.toString());
                    dot.setAttribute('cy', y.toString());
                    dot.setAttribute('r', '2');
                    dot.setAttribute('fill', '#FFD700');
                    dot.setAttribute('opacity', (baseOpacity * 0.5).toString());
                    svg.appendChild(dot);
                }
                
                if (stage >= 2) {
                    // Stage 2: Size based on OAM, polarization lines
                    const size = (3 + Math.abs(mode.oam)) * phasePulse;
                    
                    const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                    circle.setAttribute('cx', x.toString());
                    circle.setAttribute('cy', y.toString());
                    circle.setAttribute('r', size.toString());
                    circle.setAttribute('fill', '#FFD700');
                    circle.setAttribute('opacity', baseOpacity.toString());
                    svg.appendChild(circle);
                    
                    // Polarization line
                    if (mode.sigma !== 0) {
                        const lineLength = size * 2;
                        const lineAngle = mode.sigma > 0 ? 0 : Math.PI/2;
                        const x1 = x - lineLength * Math.cos(lineAngle) / 2;
                        const y1 = y - lineLength * Math.sin(lineAngle) / 2;
                        const x2 = x + lineLength * Math.cos(lineAngle) / 2;
                        const y2 = y + lineLength * Math.sin(lineAngle) / 2;
                        
                        const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                        line.setAttribute('x1', x1.toString());
                        line.setAttribute('y1', y1.toString());
                        line.setAttribute('x2', x2.toString());
                        line.setAttribute('y2', y2.toString());
                        line.setAttribute('stroke', '#FFD700');
                        line.setAttribute('stroke-width', '1');
                        line.setAttribute('opacity', baseOpacity.toString());
                        svg.appendChild(line);
                    }
                }
                
                if (stage >= 3) {
                    // Stage 3: Colors based on cost state, size based on k_perp
                    let color = '#FFD700'; // neutral
                    if (mode.cost > 0) color = '#00FFFF'; // cyan for positive
                    if (mode.cost < 0) color = '#FF6B6B'; // red for negative
                    
                    const size3 = (4 + (mode.k_perp / 32)) * phasePulse;
                    
                    const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                    circle.setAttribute('cx', x.toString());
                    circle.setAttribute('cy', y.toString());
                    circle.setAttribute('r', size3.toString());
                    circle.setAttribute('fill', color);
                    circle.setAttribute('opacity', (baseOpacity * 1.2).toString());
                    svg.appendChild(circle);
                    
                    // Entanglement visualization - connect modes with similar phases
                    for (let j = i + 1; j < lightPoints; j++) {
                        const otherMode = currentSoul.cluster[j];
                        const phaseDiff = Math.abs(mode.phi_e - otherMode.phi_e);
                        
                        if (phaseDiff < 20) { // Similar entanglement phases
                            const otherAngle = (j * 45) * Math.PI / 180;
                            const otherRadius = 60 + (Math.abs(otherMode.nu_phi) / 4) + monthOffset;
                            const otherX = centerX + otherRadius * Math.cos(otherAngle) * phasePulse;
                            const otherY = centerY + otherRadius * Math.sin(otherAngle) * phasePulse;
                            
                            const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                            line.setAttribute('x1', x.toString());
                            line.setAttribute('y1', y.toString());
                            line.setAttribute('x2', otherX.toString());
                            line.setAttribute('y2', otherY.toString());
                            line.setAttribute('stroke', '#00FFFF');
                            line.setAttribute('stroke-width', '1');
                            line.setAttribute('opacity', (baseOpacity * 0.6).toString());
                            svg.appendChild(line);
                        }
                    }
                    
                    // Mode label showing actual values
                    const label = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    label.setAttribute('x', x.toString());
                    label.setAttribute('y', (y - size3 - 2).toString());
                    label.setAttribute('text-anchor', 'middle');
                    label.setAttribute('fill', color);
                    label.setAttribute('font-size', '8');
                    label.setAttribute('opacity', baseOpacity.toString());
                    label.textContent = `M${i}`;
                    svg.appendChild(label);
                }
                
                if (stage >= 4) {
                    // Stage 4: I-Am connections, time-bin pulses
                    const centralCircle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                    centralCircle.setAttribute('cx', centerX.toString());
                    centralCircle.setAttribute('cy', centerY.toString());
                    centralCircle.setAttribute('r', '8');
                    centralCircle.setAttribute('fill', '#FFFFFF');
                    centralCircle.setAttribute('opacity', '1.0');
                    svg.appendChild(centralCircle);
                    
                    // Radial connection to I-Am
                    const radialLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    radialLine.setAttribute('x1', centerX.toString());
                    radialLine.setAttribute('y1', centerY.toString());
                    radialLine.setAttribute('x2', x.toString());
                    radialLine.setAttribute('y2', y.toString());
                    radialLine.setAttribute('stroke', '#FFFFFF');
                    radialLine.setAttribute('stroke-width', '1');
                    radialLine.setAttribute('opacity', '0.7');
                    svg.appendChild(radialLine);
                    
                    // Time-bin pulse (if in pulse phase)
                    if (mode.tau % 100 < 20) { // Pulse every ~100 units
                        const pulse = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                        pulse.setAttribute('cx', x.toString());
                        pulse.setAttribute('cy', y.toString());
                        pulse.setAttribute('r', '12');
                        pulse.setAttribute('fill', 'none');
                        pulse.setAttribute('stroke', '#00FFFF');
                        pulse.setAttribute('stroke-width', '2');
                        pulse.setAttribute('opacity', '0.8');
                        svg.appendChild(pulse);
                    }
                }
            }

            // Stage indicator text
            if (stage >= 1) {
                const stageText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                stageText.setAttribute('x', '10');
                stageText.setAttribute('y', '20');
                stageText.setAttribute('fill', '#0ff');
                stageText.setAttribute('font-size', '12');
                stageText.textContent = `Stage ${stage}: ${STAGES[stage]}`;
                svg.appendChild(stageText);
                
                // Show consciousness metrics
                const metricsText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                metricsText.setAttribute('x', '10');
                metricsText.setAttribute('y', '290');
                metricsText.setAttribute('fill', '#0ff');
                metricsText.setAttribute('font-size', '10');
                metricsText.textContent = `I-Am: ${currentSoul.iAmAffinity}% | Gaps: ${currentSoul.gapCrossings}`;
                svg.appendChild(metricsText);
            }
        }

        function hash(str) {
            let h = 0;
            for (let i = 0; i < str.length; i++) {
                h = ((h << 5) - h) + str.charCodeAt(i);
            }
            return Math.abs(h);
        }

        // Initialize
        window.addEventListener('load', generateNewSoul);
    </script>
</body>
</html> 